<!DOCTYPE html>
<html lang="ja" prefix="og: http://ogp.me/ns#">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N2X0B9FEPB"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-N2X0B9FEPB');
</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ (ãƒ–ãƒ©ã‚¦ã‚¶ã‚¿ãƒ–ç”¨ã‚¢ã‚¤ã‚³ãƒ³) -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒ</text></svg>">

<!-- SEO & Metadata -->
<title>é­å¿—å€­äººä¼ãƒ»å¤ä»£ä¸­å›½èªç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ | Ancient Japanese & Chinese Pronunciation Player</title>
<meta name="description" content="é­å¿—å€­äººä¼ã«ç™»å ´ã™ã‚‹é‚ªé¦¬å°å›½ï¼ˆé‚ªé¦¬å£¹å›½ï¼‰ã€å‘å¼¥å‘¼ã€å®˜è·åãªã©ã®å¤ä»£æ—¥æœ¬èªãŠã‚ˆã³ä¸­å›½èªï¼ˆä¸Šå¤éŸ³ãƒ»ä¸­å¤éŸ³ï¼‰ã®å†æ§‹éŸ³å£°ã‚’å†ç”Ÿãƒ»æ¯”è¼ƒã§ãã‚‹Webãƒ„ãƒ¼ãƒ«ã€‚Baxter-Sagartä½“ç³»ãªã©ã«åŸºã¥ãç™ºéŸ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚">
<meta name="keywords" content="é­å¿—å€­äººä¼,é‚ªé¦¬å°å›½,å‘å¼¥å‘¼,å¤ä»£ä¸­å›½èª,ä¸Šå¤éŸ³,ä¸­å¤éŸ³,ç™ºéŸ³,IPA,Baxter-Sagart,æ­´å²è¨€èªå­¦">

<!-- URLè¨­å®š (GitHub Pagesã«åˆã‚ã›ã¦æœ€é©åŒ–) -->
<link rel="canonical" href="https://masahiromiyazaki.github.io/-ancient-history-of-japan/Ancient-Chinese-Player.html">

<!-- Open Graph Protocol (SNSå…±æœ‰ç”¨) -->
<meta property="og:title" content="é­å¿—å€­äººä¼ãƒ»å¤ä»£ç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼">
<meta property="og:type" content="website">
<meta property="og:url" content="https://masahiromiyazaki.github.io/-ancient-history-of-japan/Ancient-Chinese-Player.html">
<meta property="og:image" content="https://masahiromiyazaki.github.io/-ancient-history-of-japan/og-image.png"> 
<meta property="og:description" content="é‚ªé¦¬å°å›½ã‚„å‘å¼¥å‘¼ã¯ã©ã†ç™ºéŸ³ã•ã‚ŒãŸã®ã‹ï¼Ÿå¤ä»£ä¸­å›½èªï¼ˆä¸Šå¤éŸ³ãƒ»ä¸­å¤éŸ³ï¼‰ã®å†æ§‹éŸ³å£°ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å†ç”Ÿã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚">
<meta property="og:site_name" content="å¤ä»£ç™ºéŸ³ç ”ç©¶ãƒ©ãƒœ">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://masahiromiyazaki.github.io/-ancient-history-of-japan/og-image.png">

<!-- æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ (JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "é­å¿—å€­äººä¼ãƒ»å¤ä»£ç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼",
  "description": "é­å¿—å€­äººä¼ã®å›ºæœ‰åè©ã‚’å¤ä»£ä¸­å›½èªã®å†æ§‹éŸ³ã§å†ç”Ÿã™ã‚‹ãƒ„ãƒ¼ãƒ«",
  "url": "https://masahiromiyazaki.github.io/-ancient-history-of-japan/Ancient-Chinese-Player.html",
  "image": "https://masahiromiyazaki.github.io/-ancient-history-of-japan/og-image.png",
  "applicationCategory": "EducationalApplication",
  "operatingSystem": "Browser",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "JPY"
  },
  "author": {
    "@type": "Person",
    "name": "Masahiro Miyazaki",
    "url": "https://masahiromiyazaki.github.io/-ancient-history-of-japan/"
  }
}
</script>

<style>
    :root {
        --primary: #4a90e2;
        --primary-dark: #357abd;
        --accent: #f5a623;
        --danger: #e53e3e;
        --seq-btn: #8e44ad;
        --bg-grad-start: #f5f7fa;
        --bg-grad-end: #c3cfe2;
        --panel-bg: #ffffff;
        --text-main: #333;
        --text-sub: #666;
        --border: #e1e4e8;
    }

    * { box-sizing: border-box; }
    
    body {
        font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, var(--bg-grad-start) 0%, var(--bg-grad-end) 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        color: var(--text-main);
    }

    .visually-hidden {
        position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
        overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
    }

    .container {
        background: var(--panel-bg);
        width: 95%;
        max-width: 1100px;
        height: 90vh;
        max-height: 850px;
        border-radius: 12px;
        box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        margin-top: 20px;
    }
    
    header {
        padding: 1rem 1.5rem;
        background: #fff;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-shrink: 0;
    }
    .header-titles h1 { margin: 0; font-size: 1.25rem; color: #2c3e50; font-weight: 600; }
    .header-titles .subtitle { color: var(--text-sub); font-size: 0.75rem; margin-top: 4px; display: block; }

    .main-content {
        display: flex;
        flex: 1;
        overflow: hidden;
    }
    
    .left-panel {
        width: 320px;
        background: #f8f9fa;
        padding: 1.2rem;
        border-right: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        gap: 1.2rem;
        flex-shrink: 0;
        overflow-y: auto;
    }

    .right-panel {
        flex: 1;
        padding: 0;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    .section-heading {
        font-size: 0.75rem;
        font-weight: 600;
        color: #8898aa;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 0.5rem;
        display: block;
        margin-top: 0;
    }

    .period-selector { display: flex; flex-direction: column; gap: 8px; }
    .period-card {
        background: white; border: 1px solid var(--border); border-radius: 8px; padding: 10px 12px;
        cursor: pointer; transition: all 0.2s; position: relative;
    }
    .period-card:hover { border-color: var(--primary); transform: translateY(-1px); }
    .period-card.active {
        border-color: var(--primary); background: #ebf4ff; box-shadow: 0 2px 5px rgba(74, 144, 226, 0.2);
    }
    .period-card input { display: none; }
    
    .p-name { font-weight: 600; font-size: 0.9rem; color: #2c3e50; display: block;}
    
    .year-text {
        color: var(--accent); font-size: 0.85em; font-weight: normal; margin-left: 6px;
    }

    .p-desc { font-size: 0.7rem; color: var(--text-sub); margin-top: 2px; display: block;}

    .check-icon {
        position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
        color: var(--primary); opacity: 0; transition: opacity 0.2s;
    }
    .period-card.active .check-icon { opacity: 1; }

    .reference-box {
        background: #eef6fc; border: 1px solid #d0e3f5; padding: 12px; border-radius: 8px;
        font-size: 0.8rem; color: #2c5282; line-height: 1.5;
    }
    .reference-box a {
        color: #3182ce; font-weight: bold; text-decoration: none; display: block; margin-top: 4px;
    }

    .info-box {
        padding: 0.8rem; background: #fff8e1; border: 1px solid #ffe082;
        border-radius: 6px; font-size: 0.75rem; color: #856404; line-height: 1.5;
    }
    .info-box h4 { margin: 0 0 6px 0; font-size: 0.8rem; }
    .info-box ul { margin: 0; padding-left: 1.2rem; }
    .info-box li { margin-bottom: 4px; }

    .audio-controls {
        background: white; padding: 12px; border-radius: 8px; border: 1px solid var(--border);
    }
    .slider-group { margin-bottom: 12px; }
    .slider-group:last-child { margin-bottom: 0; }
    .slider-label {
        display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 4px; color: var(--text-sub);
    }
    input[type=range] {
        width: 100%; height: 4px; background: #ddd; border-radius: 2px; outline: none; -webkit-appearance: none;
    }
    input[type=range]::-webkit-slider-thumb {
        -webkit-appearance: none; width: 14px; height: 14px; background: var(--primary);
        border-radius: 50%; cursor: pointer; transition: background 0.2s;
    }
    select.voice-select {
        width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.8rem; margin-top: 4px;
        background: #fdfdfd;
    }

    .player-area {
        padding: 1.2rem; background: white; border-bottom: 1px solid var(--border); flex-shrink: 0;
        display: flex; flex-direction: column; gap: 10px;
    }
    
    .badge-container {
        display: flex; align-items: center; flex-wrap: wrap; gap: 8px; margin-bottom: 0.5rem;
    }
    .selected-word-badge, .selected-period-badge {
        font-size: 0.75rem; padding: 2px 8px; border-radius: 4px; font-weight: 600; border: 1px solid; display: none;
    }
    .selected-word-badge { color: var(--primary-dark); background: #eef6fc; border-color: #d0e3f5; }
    .selected-period-badge { color: #d97706; background: #fffaf0; border-color: #fbd38d; }

    .sm-btn {
        background: transparent; border: 1px solid #ccc; border-radius: 4px; font-size: 0.75rem;
        cursor: pointer; padding: 3px 10px; color: #555; display: flex; align-items: center; gap: 5px;
        transition: all 0.2s; text-decoration: none;
    }
    .sm-btn:hover { background: #f0f0f0; color: #333; }
    .copy-link-btn.copied { border-color: var(--primary); color: var(--primary); background: #f0f8ff; }
    .x-share-btn:hover { background: #000; color: #fff; border-color: #000; } 

    textarea {
        width: 100%; min-height: 70px; height: 70px; padding: 10px; font-size: 1.1rem;
        border: 1px solid var(--border); border-radius: 8px; resize: none;
        font-family: 'Segoe UI', sans-serif; background: #fdfdfd; transition: border-color 0.2s;
    }
    textarea:focus { outline: none; border-color: var(--primary); background: white; }

    .controls-row { display: flex; align-items: center; gap: 10px; }
    .status-badge {
        flex: 1; display: flex; align-items: center; background: #f0f4ff; color: var(--primary-dark);
        padding: 0 12px; height: 40px; border-radius: 6px; font-size: 0.8rem; font-weight: 600;
        overflow: hidden; white-space: nowrap;
    }
    .sound-bars {
        display: flex; align-items: flex-end; gap: 3px; height: 16px; margin-left: auto;
    }
    .bar { width: 4px; height: 3px; background-color: #cbd5e0; border-radius: 2px; }
    .playing .bar {
        background-color: var(--primary); animation: bounce 0.5s infinite ease-in-out;
    }
    .playing .bar:nth-child(1) { animation-delay: 0.0s; }
    .playing .bar:nth-child(2) { animation-delay: 0.1s; }
    .playing .bar:nth-child(3) { animation-delay: 0.3s; }
    .playing .bar:nth-child(4) { animation-delay: 0.2s; }
    .playing .bar:nth-child(5) { animation-delay: 0.4s; }
    @keyframes bounce { 0%, 100% { height: 3px; } 50% { height: 16px; } }

    .btn-group { display: flex; gap: 8px; }
    .btn {
        border: none; padding: 0 16px; height: 40px; border-radius: 6px; font-weight: 500;
        cursor: pointer; font-size: 0.85rem; transition: all 0.2s;
        display: flex; align-items: center; justify-content: center;
    }
    .btn-play { background: var(--primary); color: white; }
    .btn-play:hover { background: var(--primary-dark); }
    .btn-stop { background: #e2e8f0; color: #4a5568; }
    .btn-stop:hover { background: #cbd5e0; }
    .btn-seq { background: #f3e5f5; color: var(--seq-btn); border: 1px solid #e1bee7; }
    .btn-seq:hover { background: #e1bee7; }
    .btn-seq.active { background: var(--seq-btn); color: white; border-color: var(--seq-btn); }

    .preview-line {
        font-size: 0.8rem; color: var(--text-sub); height: 1.2em; 
        white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }

    .list-area {
        flex: 1; background: #f8f9fa; overflow-y: auto; padding: 0; position: relative;
    }
    
    .search-container {
        position: sticky; top: 0; background: #f8f9fa; z-index: 20; padding: 10px 1rem 0 1rem;
    }
    .search-box {
        width: 100%; padding: 10px 12px; border: 1px solid #e1e4e8; border-radius: 6px;
        font-size: 0.9rem; outline: none; transition: border 0.2s;
    }
    .search-box:focus { border-color: var(--primary); background: white; }

    .list-container { padding: 1rem; padding-bottom: 2rem; }
    .category-group { margin-bottom: 1.5rem; }
    
    .category-header {
        position: sticky; top: 0; background: rgba(248, 249, 250, 0.95); backdrop-filter: blur(5px);
        z-index: 10; padding: 8px 0; border-bottom: 1px solid rgba(0,0,0,0.05);
        margin-bottom: 10px; font-size: 0.85rem; font-weight: 600; color: #4a5568;
        display: flex; align-items: center; margin-top: 0;
    }
    .category-header::before {
        content: ''; display: block; width: 4px; height: 1em; background: var(--accent);
        margin-right: 8px; border-radius: 2px;
    }
    .item-grid {
        display: grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap: 10px;
    }
    .word-card {
        background: white; border: 1px solid #e1e4e8; border-radius: 6px; padding: 10px 12px;
        cursor: pointer; transition: all 0.15s; display: flex; flex-direction: column;
    }
    .word-card:hover {
        border-color: var(--primary); box-shadow: 0 4px 6px rgba(0,0,0,0.05); transform: translateY(-2px);
    }
    .wc-kanji { font-weight: 500; color: #2d3748; font-size: 1rem; margin-bottom: 2px; }
    .wc-ja { font-size: 0.7rem; color: #718096; margin-bottom: 6px; border-bottom: 1px dashed #eee; padding-bottom: 3px; }
    .wc-pron { font-size: 0.75rem; color: #555; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-family: 'Segoe UI', monospace; }
    .text-variant { color: var(--danger); }
    .wc-note { font-size: 0.65rem; color: var(--danger); margin-top: 4px; }

    .seo-content {
        width: 95%; max-width: 1100px; margin: 2rem auto;
        background: rgba(255,255,255,0.8); padding: 1.5rem; border-radius: 12px;
        color: #444; font-size: 0.9rem; line-height: 1.6;
    }
    .seo-content h2 { font-size: 1.2rem; color: #2c3e50; border-bottom: 2px solid #ddd; padding-bottom: 0.5rem; margin-bottom: 1rem; }
    .seo-content p { margin-bottom: 1rem; }

    @media (max-width: 768px) {
        .container { height: auto; max-height: none; width: 100%; border-radius: 0; margin-top: 0; }
        .main-content { flex-direction: column; }
        .left-panel { width: 100%; border-right: none; border-bottom: 1px solid var(--border); padding: 1rem;}
        .item-grid { grid-template-columns: repeat(2, 1fr); }
        header { padding: 1rem; }
        .period-selector { flex-direction: row; overflow-x: auto; padding-bottom: 5px; }
        .period-card { min-width: 200px; flex-shrink: 0; }
    }
</style>
</head>
<body>
<div class="container">
<header>
<div class="header-titles">
<h1>ğŸŒ é­å¿—å€­äººä¼ãƒ»å¤ä»£ç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼</h1>
<span class="subtitle">Wei zhi Wajin den: Ancient Pronunciation Player</span>
</div>
</header>

<main class="main-content">
    <nav class="left-panel" aria-label="è¨­å®šã¨æ™‚ä»£é¸æŠ">
        
        <section>
            <h2 class="section-heading">æ™‚ä»£ãƒ»å†æ§‹ä½“ç³»ã®é¸æŠ</h2>
            <div class="period-selector">
                <label class="period-card" id="card-old" onclick="selectPeriod(this, 'old')">
                    <input type="radio" name="period" value="old">
                    <span class="p-name">æ™©æœŸä¸Šå¤éŸ³ <span class="year-text">~200 BCE</span></span>
                    <span class="p-desc">Baxter-Sagartä½“ç³»</span>
                    <span class="check-icon">âœ”</span>
                </label>

                <label class="period-card active" id="card-third" onclick="selectPeriod(this, 'third')">
                    <input type="radio" name="period" value="third" checked>
                    <span class="p-name">3ä¸–ç´€æ¨å®šéŸ³ <span class="year-text">~280 CE</span></span>
                    <span class="p-desc">æ¨å®šãƒ¢ãƒ‡ãƒ«</span>
                    <span class="check-icon">âœ”</span>
                </label>

                <label class="period-card" id="card-mid" onclick="selectPeriod(this, 'mid')">
                    <input type="radio" name="period" value="mid">
                    <span class="p-name">ä¸­å¤éŸ³ <span class="year-text">~600 CE</span></span>
                    <span class="p-desc">åˆ‡éŸ»ä½“ç³»</span>
                    <span class="check-icon">âœ”</span>
                </label>
            </div>
        </section>

        <div class="reference-box">
            ğŸ“š 3ä¸–ç´€æ¨å®šéŸ³ã®è©³ç´°ã¯ã“ã¡ã‚‰:
            <a href="https://masahiromiyazaki.github.io/-ancient-history-of-japan/japanese-phonetics-3rd-century.html" target="_blank" rel="noopener noreferrer">è³‡æ–™ãƒšãƒ¼ã‚¸ã¸ç§»å‹• â†—</a>
        </div>

        <div class="info-box">
            <h4>âš ï¸ ã”åˆ©ç”¨ä¸Šã®æ³¨æ„</h4>
            <ul>
                <li><strong>æ¨å¥¨ç’°å¢ƒ:</strong> Windows 11 + Chrome (è‹±èªéŸ³å£°ã‚¨ãƒ³ã‚¸ãƒ³)ã€‚</li>
                <li><strong>èµ¤å­—ã®èªå¥</strong>ã¯å¾Œä¸–ã®å²æ›¸ã‚„è¨‚æ­£èª¬ã«åŸºã¥ãè¡¨è¨˜ã§ã™ã€‚</li>
                <li>ã€ŒãŠã¾ã‘ã€ã‚’é¸æŠã™ã‚‹ã¨ã€æ™‚ä»£ãƒœã‚¿ãƒ³ãŒãƒ©ãƒ†ãƒ³èªç”¨ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚</li>
            </ul>
        </div>

        <section style="margin-top:auto;">
            <h2 class="section-heading">å†ç”Ÿè¨­å®š</h2>
            <div class="audio-controls">
                <div class="slider-group">
                    <div class="slider-label"><span>å£°ã®ç¨®é¡ (è‹±èªæ¨å¥¨)</span></div>
                    <select id="voiceSelect" class="voice-select" aria-label="éŸ³å£°åˆæˆã®å£°ã‚’é¸æŠ">
                        <option value="">è‡ªå‹•é¸æŠ</option>
                    </select>
                </div>
                <div class="slider-group">
                    <div class="slider-label"><span>é€Ÿåº¦</span><span id="rateValue">1.0</span></div>
                    <input type="range" id="rate" min="0.1" max="3" step="0.1" value="1.0" aria-label="å†ç”Ÿé€Ÿåº¦">
                </div>
                <div class="slider-group">
                    <div class="slider-label"><span>ãƒ”ãƒƒãƒ</span><span id="pitchValue">1.0</span></div>
                    <input type="range" id="pitch" min="0" max="2" step="0.1" value="1.0" aria-label="å£°ã®é«˜ã•">
                </div>
                <div class="slider-group">
                    <div class="slider-label"><span>éŸ³é‡</span><span id="volumeValue">1.0</span></div>
                    <input type="range" id="volume" min="0" max="1" step="0.1" value="1.0" aria-label="éŸ³é‡">
                </div>
            </div>
        </section>
    </nav>

    <div class="right-panel">
        
        <section class="player-area" aria-label="ç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼">
            <h2 class="visually-hidden">ç™ºéŸ³å†ç”Ÿã‚¨ãƒªã‚¢</h2>
            <div class="badge-container">
                <span class="section-heading" style="margin: 0; margin-right: 5px;">ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› (IPAè¨˜å·)</span>
                <span id="currentWordDisplay" class="selected-word-badge"></span>
                <span id="currentPeriodDisplay" class="selected-period-badge"></span>
                
                <button id="copyUrlBtn" class="sm-btn copy-link-btn" title="ç¾åœ¨ã®URLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼">
                    ğŸ”— ã‚³ãƒ”ãƒ¼
                </button>
                <button id="shareXBtn" class="sm-btn x-share-btn" title="X(Twitter)ã§å…±æœ‰">
                    ğ• ã§å…±æœ‰
                </button>
            </div>
            
            <div class="input-wrapper">
                <textarea id="textInput" placeholder="ä¸‹ã®ä¸€è¦§ã‹ã‚‰èªå¥ã‚’é¸æŠã™ã‚‹ã‹ã€IPAã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..." aria-label="ç™ºéŸ³è¨˜å·(IPA)å…¥åŠ›æ¬„"></textarea>
            </div>
            
            <div id="conversionPreview" class="preview-line" aria-live="polite"></div>

            <div class="controls-row">
                <div id="playStatus" class="status-badge" role="status">
                    <span id="statusLabel" style="margin-right: auto;">å¾…æ©Ÿä¸­</span>
                    <div class="sound-bars">
                        <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-seq" id="historyBtn" title="ä¸Šå¤éŸ³â†’3ä¸–ç´€â†’ä¸­å¤éŸ³ã®é †ã«é€£ç¶šå†ç”Ÿ">ğŸ” å¤‰é·å†ç”Ÿ</button>
                    <button class="btn btn-stop" id="stopBtn">åœæ­¢</button>
                    <button class="btn btn-play" id="speakBtn">â–¶ å†ç”Ÿ</button>
                </div>
            </div>
        </section>

        <section class="list-area" aria-label="èªå¥ä¸€è¦§">
            <h2 class="visually-hidden">åéŒ²èªå¥ãƒªã‚¹ãƒˆ</h2>
            <div class="search-container">
                <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” èªå¥ã‚’æ¤œç´¢ (ä¾‹: å‘å¼¥å‘¼, å¥´åœ‹...)" aria-label="èªå¥æ¤œç´¢">
            </div>
            
            <div class="list-container" id="examplesList">
                <!-- Javascript will populate this -->
            </div>
        </section>
    </div>
</main>
</div>
<article class="seo-content">
<h2>ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦</h2>
<p>
ã€Œé­å¿—å€­äººä¼ãƒ»å¤ä»£ç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã€ã¯ã€3ä¸–ç´€ã®ä¸­å›½ã®æ­´å²æ›¸ã€é­å¿—å€­äººä¼ã€ã«ç™»å ´ã™ã‚‹æ—¥æœ¬ã®åœ°åï¼ˆé‚ªé¦¬å°å›½ã€ä¼Šéƒ½å›½ãªã©ï¼‰ã‚„äººåï¼ˆå‘å¼¥å‘¼ã€é›£å‡ç±³ãªã©ï¼‰ãŒã€å½“æ™‚ã®ä¸­å›½ã§ã©ã®ã‚ˆã†ã«ç™ºéŸ³ã•ã‚Œã¦ã„ãŸã‹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãã‚‹Webãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
</p>
<p>
Baxter-Sagartä½“ç³»ã«åŸºã¥ãã€Œä¸Šå¤éŸ³ã€ã€3ä¸–ç´€å½“æ™‚ã®æ¨å®šéŸ³ã€ãã—ã¦å¾Œã®æ™‚ä»£ã®ã€Œä¸­å¤éŸ³ã€ã®3ã¤ã®ä½“ç³»ã‚’åˆ‡ã‚Šæ›¿ãˆã¦è´ãæ¯”ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç¾ä»£ã®æ—¥æœ¬èªèª­ã¿ã¨ã¯ç•°ãªã‚‹ã€å¤ä»£ã®éŸ¿ãã‚’ä½“é¨“ã—ã¦ãã ã•ã„ã€‚
</p>
<h3>ä¸»ãªæ©Ÿèƒ½</h3>
<ul>
<li><strong>3ã¤ã®æ™‚ä»£åŒºåˆ†:</strong> ç´€å…ƒå‰ã®ä¸Šå¤éŸ³ã€é‚ªé¦¬å°å›½æ™‚ä»£ã®3ä¸–ç´€éŸ³ã€éš‹å”æ™‚ä»£ã®ä¸­å¤éŸ³ã‚’æ¯”è¼ƒå¯èƒ½ã€‚</li>
<li><strong>IPAå†ç”Ÿ:</strong> å›½éš›éŸ³å£°è¨˜å·(IPA)ã‚’å…¥åŠ›ã—ã¦ä»»æ„ã®å¤ä»£éŸ³å£°ã‚’åˆæˆå¯èƒ½ã€‚</li>
<li><strong>å¤‰é·å†ç”Ÿ:</strong> ã²ã¨ã¤ã®å˜èªãŒæ™‚ä»£ã¨ã¨ã‚‚ã«ã©ã†å¤‰åŒ–ã—ãŸã‹ã‚’é€£ç¶šå†ç”Ÿã€‚</li>
</ul>
</article>
<script>
// --- Data & Config ---
var synth = window.speechSynthesis;
var voices = [];
var currentAncientPeriod = 'third';
var selectedWordIndex = null;
var isHistoryPlaying = false;

// ãƒ©ãƒ™ãƒ«ç®¡ç†
var defaultLabels = {
old: { name: 'æ™©æœŸä¸Šå¤éŸ³', year: '~200 BCE', desc: 'Baxter-Sagartä½“ç³»' },
third: { name: '3ä¸–ç´€æ¨å®šéŸ³', year: '~280 CE', desc: 'æ¨å®šãƒ¢ãƒ‡ãƒ«' },
mid: { name: 'ä¸­å¤éŸ³', year: '~600 CE', desc: 'åˆ‡éŸ»ä½“ç³»' }
};

var periodNames = {
'old': defaultLabels.old.name,
'third': defaultLabels.third.name,
'mid': defaultLabels.mid.name
};

var periodOrder = ['old', 'third', 'mid'];

var ancientData = [
// ä¸»è¦å›½å
{ type: 'ä¸»è¦å›½å', k: 'å°æµ·åœ‹', ja: 'ãŸã„ã‹ã„ã“ã (å¯¾é¦¬)', old: '*tË¤É™j-s-*mÌ¥Ë¤É™Ê”', third: '*tuj-mÉ”Ê”', mid: 'twojH-hmojX' },
{ type: 'ä¸»è¦å›½å', k: 'ä¸€å¤§åœ‹', ja: 'ã„ã¡ã ã„ã“ã (å£±å²)', old: '*Ê”it-*lË¤at-s', third: '*Ê”it-dat', mid: "'jit-dajH" },
{ type: 'ä¸»è¦å›½å', k: 'æœ«ç›§åœ‹', ja: 'ã¾ã¤ã‚‰ã“ã', old: '*mË¤at-*ra', third: '*mat-ra', mid: 'mwat-lu' },
{ type: 'ä¸»è¦å›½å', k: 'ä¼Šéƒ½åœ‹', ja: 'ã„ã¨ã“ã', old: '*Ê”ij-*tË¤a', third: '*Ê”ij-tÉ”', mid: "'jij-tuo" },
{ type: 'ä¸»è¦å›½å', k: 'å¥´åœ‹', ja: 'ãªã“ã', old: '*nË¤a', third: '*nÉ”', mid: 'nu' },
{ type: 'ä¸»è¦å›½å', k: 'ä¸å½Œåœ‹', ja: 'ãµã¿ã“ã', old: '*pÉ™-*mij', third: '*pÉ™-mij', mid: 'pjuw-mjie' },
{ type: 'ä¸»è¦å›½å', k: 'æŠ•é¦¬åœ‹', ja: 'ã¨ã†ã¾ã“ã', old: '*C.do-*mË¤raÊ”', third: '*do-maÊ”', mid: 'duw-mhaeX' },
{ type: 'ä¸»è¦å›½å', k: 'é‚ªé¦¬å£¹åœ‹', ja: 'ã‚„ã¾ã„ã¡ã“ã', old: '*s-la-*mË¤raÊ”-*Ê”it', third: '*zja-maÊ”-it', mid: "zjia-mhaeX-'jit" },
{ type: 'ä¸»è¦å›½å', k: 'é‚ªé¦¬è‡ºåœ‹', ja: 'ã‚„ã¾ãŸã„ã“ã', old: '*s-la-*mË¤raÊ”-*lË¤É™', third: '*zja-maÊ”-lË¤É™', mid: 'zjia-mhaeX-doj', highlight: true, note: 'â€»é­å¿—åŸæ–‡ã¯ã€Œå£¹ã€' },
{ type: 'ä¸»è¦å›½å', k: 'ç‹—å¥´åœ‹', ja: 'ããªã“ã', old: '*kË¤oÊ”-*nË¤a', third: '*kÉ”Ê”-nÉ”', mid: 'kuwX-nu' },

// å‚å›½
{ type: 'å‚å›½', k: 'æ–¯é¦¬åœ‹', ja: 'ã—ã¾ã“ã', old: '*sÉ™-*mË¤raÊ”', third: '*sÉ™-maÊ”', mid: 'sje-mhaeX' },
{ type: 'å‚å›½', k: 'å·²ç™¾æ”¯åœ‹', ja: 'ã„ã»ãã“ã', old: '*É¢(r)É™Ê”-*pË¤rak-*kje', third: '*jiÊ”-prak-kje', mid: 'yiX-paek-tsye' },
{ type: 'å‚å›½', k: 'ä¼Šé‚ªåœ‹', ja: 'ã„ã‚„ã“ã', old: '*Ê”ij-*s-la', third: '*Ê”ij-zja', mid: "'jij-zjia" },
{ type: 'å‚å›½', k: 'éƒ½æ”¯åœ‹', ja: 'ã¨ãã“ã', old: '*tË¤a-*kje', third: '*tÉ”-kje', mid: 'tuo-tsye' },
{ type: 'å‚å›½', k: 'å½Œå¥´åœ‹', ja: 'ã¿ãªã“ã', old: '*mij-*nË¤a', third: '*mij-nÉ”', mid: 'mjie-nu' },
{ type: 'å‚å›½', k: 'å¥½å¤éƒ½åœ‹', ja: 'ã“ã†ã“ã¨ã“ã', old: '*qÊ°Ë¤uÊ”-*kË¤aÊ”-*tË¤a', third: '*xoÊ”-kÉ”Ê”-tÉ”', mid: 'huwX-kuX-tuo' },
{ type: 'å‚å›½', k: 'ä¸å‘¼åœ‹', ja: 'ãµã“ã“ã', old: '*pÉ™-*qÊ°Ë¤a', third: '*pÉ™-qÉ”', mid: 'pjuw-hu' },
{ type: 'å‚å›½', k: 'å§å¥´åœ‹', ja: 'ã—ã‚ƒãªã“ã', old: '*tsajÊ”-*nË¤a', third: '*tsjaÊ”-nÉ”', mid: 'tsjoX-nu' },
{ type: 'å‚å›½', k: 'å°è˜‡åœ‹', ja: 'ã¤ã„ãã“ã', old: '*tË¤É™j-s-*sË¤a', third: '*tuj-sÉ”', mid: 'twojH-su' },
{ type: 'å‚å›½', k: 'è˜‡å¥´åœ‹', ja: 'ããªã“ã', old: '*sË¤a-*nË¤a', third: '*sÉ”-nÉ”', mid: 'su-nu' },
{ type: 'å‚å›½', k: 'å‘¼é‚‘åœ‹', ja: 'ã“ã‚†ã†ã“ã', old: '*qÊ°Ë¤a-*Ê”ip', third: '*qÉ”-Ê”ip', mid: "hu-'ip" },
{ type: 'å‚å›½', k: 'è¯å¥´è˜‡å¥´åœ‹', ja: 'ã‹ãªããªã“ã', old: '*qÊ·Ë¤ra-*nË¤a-*sË¤a-*nË¤a', third: '*qÊ·aj-nÉ”-sÉ”-nÉ”', mid: 'hwa-nu-su-nu' },
{ type: 'å‚å›½', k: 'é¬¼åœ‹', ja: 'ãã“ã', old: '*qÊ·É™jÊ”', third: '*kujÊ”', mid: 'kjwijX' },
{ type: 'å‚å›½', k: 'çˆ²å¾åœ‹', ja: 'ã„ã”ã“ã', old: '*É¢Ê·aj-*Å‹Ë¤a', third: '*wÉ™j-Å‹É”', mid: 'hjwe-ngu' },
{ type: 'å‚å›½', k: 'é¬¼å¥´åœ‹', ja: 'ããªã“ã', old: '*qÊ·É™jÊ”-*nË¤a', third: '*kujÊ”-nÉ”', mid: 'kjwijX-nu' },
{ type: 'å‚å›½', k: 'é‚ªé¦¬åœ‹', ja: 'ã‚„ã¾ã“ã', old: '*s-la-*mË¤raÊ”', third: '*zja-maÊ”', mid: 'zjia-mhaeX' },
{ type: 'å‚å›½', k: 'èº¬è‡£åœ‹', ja: 'ãã‚…ã†ã—ã‚“ã“ã', old: '*kÊ·É™Å‹-*[g]in', third: '*kuÅ‹-gin', mid: 'kjuwng-zyin' },
{ type: 'å‚å›½', k: 'å·´åˆ©åœ‹', ja: 'ã¯ã‚Šã“ã', old: '*prË¤aj-*C.ri[t]-s', third: '*paj-riÊ”', mid: 'pae-lijH' },
{ type: 'å‚å›½', k: 'æ”¯æƒŸåœ‹', ja: 'ãã„ã“ã', old: '*kje-*C.wij', third: '*kje-wij', mid: 'tsye-ywij' },
{ type: 'å‚å›½', k: 'çƒå¥´åœ‹', ja: 'ã†ãªã“ã', old: '*Ê”Ë¤a-*nË¤a', third: '*Ê”É”-nÉ”', mid: "'u-nu" },

// äººå
{ type: 'äººå', k: 'å‘å½Œå‘¼', ja: 'ã²ã¿ã“', old: '*pe-*mij-*qÊ°Ë¤a', third: '*pij-mij-qÉ”', mid: 'pjie-mjie-hu' },
{ type: 'äººå', k: 'å£¹èˆ‡', ja: 'ã„ã‚ˆ', old: '*Ê”it-*laÊ”', third: '*Ê”it-jo', mid: "'jit-yoX" },
{ type: 'äººå', k: 'è‡ºèˆ‡', ja: 'ã¨ã‚ˆ', old: '*lË¤É™-*laÊ”', third: '*da-jo', mid: 'doj-yoX', highlight: true, note: 'â€»é­å¿—åŸæ–‡ã¯ã€Œå£¹ã€' },
{ type: 'äººå', k: 'é›£å‡ç±³', ja: 'ãªã—ã‚', old: '*nË¤an-*s-tÉ™Å‹-*mË¤ejÊ”', third: '*nan-s(j)É™Å‹-mÉ™jÊ”', mid: 'nan-sying-mejX' },
{ type: 'äººå', k: 'éƒ½å¸‚ç‰›åˆ©', ja: 'ã¨ã—ã”ã‚Š', old: '*tË¤a-*d(r)É™Ê”-*Å‹Ê·a-*C.ri[t]-s', third: '*tÉ”-dÊ‘iÊ”-Å‹o-raj', mid: 'tuo-dzyiX-ngjuw-lijH' },
{ type: 'äººå', k: 'ä¼Šè²è€†', ja: 'ã„ã›ã„ã', old: '*Ê”ij-*lÌ¥eÅ‹-*[g]ij', third: '*Ê”ij-s(j)eÅ‹-gij', mid: "'jij-syeng-gij" },
{ type: 'äººå', k: 'æ–é‚ªç‹—', ja: 'ãˆãã‚„ã', old: '*lak-*s-la-*kË¤oÊ”', third: '*jak-zja-kÉ”Ê”', mid: 'yek-zjia-kuwX' },
{ type: 'äººå', k: 'è¼‰æ–¯', ja: 'ã•ã—', old: '*tsË¤É™Ê”-*sÉ™', third: '*tsÉ™Ê”-se', mid: 'tsojH-sje' },
{ type: 'äººå', k: 'çƒè¶Š', ja: 'ãŠãˆã¤', old: '*Ê”Ë¤a-*É¢Ê·at', third: '*Ê”É”-É¢Ê·at', mid: "'u-hwat" },
{ type: 'äººå', k: 'å‘å½Œå¼“å‘¼', ja: 'ã²ã¿ãã“', old: '*pe-*mij-*kÊ·É™Å‹-*qÊ°Ë¤a', third: '*pij-mij-k(r)uÅ‹-qÉ”', mid: 'pjie-mjie-kjuwng-hu' },

// å®˜è·å
{ type: 'å®˜è·å', k: 'å‘ç‹—', ja: 'ã²ã“', old: '*pe-*kË¤oÊ”', third: '*pij-kÉ”Ê”', mid: 'pjie-kuwX' },
{ type: 'å®˜è·å', k: 'å‘å¥´æ¯é›¢', ja: 'ã²ãªã‚‚ã‚Š', old: '*pe-*nË¤a-*mË¤É™Ê”-*C.raj', third: '*pij-nÉ”-moÊ”-raj', mid: 'pjie-nu-muwX-ljej' },
{ type: 'å®˜è·å', k: 'çˆ¾æ”¯', ja: 'ã«ã', old: '*neÊ”-*kje', third: '*ne-kje', mid: 'nyeX-tsye' },
{ type: 'å®˜è·å', k: 'æ³„è¬¨è§š', ja: 'ã›ã¤ã‚‚ã“', old: '*ljet-*ma-*kË¤a', third: '*set-ma-kÉ”', mid: 'sjet-mu-ku' },
{ type: 'å®˜è·å', k: 'æŸ„æ¸ è§š', ja: 'ã¸ã„ãã‚‡ã“', old: '*praÅ‹Ê”-*g(r)a-*kË¤a', third: '*pjaÅ‹-gja-kÉ”', mid: 'pjaengX-gja-ku' },
{ type: 'å®˜è·å', k: 'å…•é¦¬è§š', ja: 'ã—ã¾ã“', old: '*s.É¢ijÊ”-*mË¤raÊ”-*kË¤a', third: '*ziÊ”-maÊ”-kÉ”', mid: 'zijX-mhaeX-ku' },
{ type: 'å®˜è·å', k: 'å¤šæ¨¡', ja: 'ãŸã‚‚', old: '*tË¤aj-*ma', third: '*tË¤aj-mÉ”', mid: 'ta-mu' },
{ type: 'å®˜è·å', k: 'å½Œå½Œ', ja: 'ã¿ã¿', old: '*mij-*mij', third: '*mij-mij', mid: 'mjie-mjie' },
{ type: 'å®˜è·å', k: 'å½Œå½Œé‚£åˆ©', ja: 'ã¿ã¿ãªã‚Š', old: '*mij-*mij-*nË¤aj-*C.ri[t]-s', third: '*mij-mij-nÉ”-raj', mid: 'mjie-mjie-na-lijH' },
{ type: 'å®˜è·å', k: 'ä¼Šæ”¯é¦¬', ja: 'ã„ãã¾', old: '*Ê”ij-*kje-*mË¤raÊ”', third: '*Ê”ij-kje-maÊ”', mid: "'jij-tsye-mhaeX" },
{ type: 'å®˜è·å', k: 'å½Œé¦¬å‡', ja: 'ã¿ã¾ã—ã‚‡ã†', old: '*mij-*mË¤raÊ”-*s-tÉ™Å‹', third: '*mij-maÊ”-s(j)É™Å‹', mid: 'mjie-mhaeX-sying' },
{ type: 'å®˜è·å', k: 'å½Œé¦¬ç²æ”¯', ja: 'ã¿ã¾ã‹ãã', old: '*mij-*mË¤raÊ”-*É¢Ê·Ë¤rek-*kje', third: '*mij-maÊ”-É¢Ê·Ë¤ek-kje', mid: 'mjie-mhaeX-hwak-tsye' },
{ type: 'å®˜è·å', k: 'å¥´ä½³é®', ja: 'ãªã‹ã¦ã„', old: '*nË¤a-*kË¤re-*tij', third: '*nÉ”-kaj-tej', mid: 'nu-kea-tej' },
{ type: 'å®˜è·å', k: 'ç‹—å¤æ™ºå‘ç‹—', ja: 'ãã“ã¡ã²ã“', old: '*kË¤oÊ”-*kË¤aÊ”-*trje-*pe-*kË¤oÊ”', third: '*kÉ”Ê”-kÉ”Ê”-tij-pij-kÉ”Ê”', mid: 'kuwX-kuX-tsye-pjie-kuwX' },
{ type: 'å®˜è·å', k: 'å¤§å€­', ja: 'ã ã„ã‚', old: '*lË¤at-s-*Ê”Ê·aj', third: '*dat-Ê”waj', mid: "dajH-'uaj" },

// ãŠã¾ã‘ (ãƒ©ãƒ†ãƒ³èªå¤‰é·)
{
type: 'ãŠã¾ã‘ï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰',
k: 'æ¥ãŸã€è¦‹ãŸã€å‹ã£ãŸ',
ja: 'ã‚¦ã‚§ãƒ¼ãƒ‹ãƒ¼ãƒ»ã‚¦ã‚£ãƒ¼ãƒ‡ã‚£ãƒ¼...',
old: 'weËniË wiËdiË wiËkiË',
third: 'weËniË wiËdiË wiËkiË',
mid: 'veni vidi viÊ§i',
highlight: true,
note: 'ç¾…: Veni, vidi, vici',
labels: {
old: { name: 'å¤å…¸ãƒ©ãƒ†ãƒ³èª', year: '~100 BCE', desc: 'Classical Latin' },
third: { name: 'ä¿—ãƒ©ãƒ†ãƒ³èª', year: '~4c CE', desc: 'Vulgar Latin' },
mid: { name: 'æ•™ä¼šãƒ©ãƒ†ãƒ³èª', year: 'Medieval', desc: 'Ecclesiastical' }
}
},
{
type: 'ãŠã¾ã‘ï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰',
k: 'ãƒ¦ãƒªã‚¦ã‚¹ãƒ»ã‚«ã‚¨ã‚µãƒ«',
ja: 'ã‚¸ãƒ¥ãƒªã‚¢ã‚¹ãƒ»ã‚·ãƒ¼ã‚¶ãƒ¼',
old: 'juËliÊŠs kaesar',
third: 'juËliÊŠs kesar',
mid: 'juËliÊŠs tÊƒesar',
highlight: true,
note: 'å¤‰é·: ã‚«ã‚¨ã‚µãƒ«(å¤)â†’ã‚±ã‚µãƒ«(ä¿—)â†’ãƒã‚§ã‚µãƒ«(æ•™)',
labels: {
old: { name: 'å¤å…¸ãƒ©ãƒ†ãƒ³èª', year: '~100 BCE', desc: 'Classical Latin' },
third: { name: 'ä¿—ãƒ©ãƒ†ãƒ³èª', year: '~4c CE', desc: 'Vulgar Latin' },
mid: { name: 'æ•™ä¼šãƒ©ãƒ†ãƒ³èª', year: 'Medieval', desc: 'Ecclesiastical' }
}
}
];

var ipaToSpeech = {
// æ¯éŸ³è¨­å®š
'É‘': 'a', 'Ã¦': 'a', 'ÊŒ': 'u', 'É’': 'o', 'É”': 'o',
'É™': 'u', 'É›': 'e', 'Å“': 'u', 'Éª': 'i',
'É¨': 'i', 'É¯': 'u', 'ÊŠ': 'u', 'Ã¸': 'eu',
'u': 'oo', 'i': 'ee', 'e': 'e', 'o': 'o', 'a': 'a',
'jij': 'yee', 'tuo': 'to',
'ja': 'ya', 'ju': 'yu', 'jo': 'yo', 'je': 'ie', 'ji': 'yee',
'jÉ™': 'yu', 'É™j': 'ui', 'j': 'i', 'y': 'y',
's.': 'su', 'mÌ¥': 'hm', 'nÌ¥': 'hn', 'lÌ¥': 'hl',
'Êƒ': 'sh', 'Ê’': 'zh', 'Î¸': 'th', 'Ã°': 'dh', 'Å‹': 'ng',
'Ê”': '', 'É¡': 'g', 'Ã§': 'hy', 'x': 'kh', 'É£': 'gh',
'Ï‡': 'kh', 'Ê': 'r', 'Î²': 'v', 'É¸': 'f',
'Ê': 'li', 'É²': 'ny', 'Ê§': 'ch', 'Ê¤': 'j',
'ts': 'z', 'dz': 'dz', 'Ê‘': 'zh', 'É¢': 'g', 'mw': 'mu',
'Ê·': 'u', 'hw': 'hu', 'w': 'w', 'kw': 'ku', 'gw': 'gu',
'Ë¤': '', 'Ê°': 'h', 'Ê²': 'y', 'Ë': '', 'Ëˆ': '', 'ËŒ': '', '.': '',
'[': '', ']': '', '/': '', '*': '', '~': '', 'q': 'k',
'-': '', 'C.': '', 'X': '', 'H': '', "'": '', ' ': ' ', '(': '', ')': ''
};

// --- UI Logic ---

function updatePeriodLabels(customLabels) {
var map = customLabels || defaultLabels;

var dOld = map.old;
document.querySelector('#card-old .p-name').innerHTML = `${dOld.name} <span class="year-text">${dOld.year}</span>`;
document.querySelector('#card-old .p-desc').textContent = dOld.desc;

var dThird = map.third;
document.querySelector('#card-third .p-name').innerHTML = `${dThird.name} <span class="year-text">${dThird.year}</span>`;
document.querySelector('#card-third .p-desc').textContent = dThird.desc;

var dMid = map.mid;
document.querySelector('#card-mid .p-name').innerHTML = `${dMid.name} <span class="year-text">${dMid.year}</span>`;
document.querySelector('#card-mid .p-desc').textContent = dMid.desc;

periodNames['old'] = dOld.name;
periodNames['third'] = dThird.name;
periodNames['mid'] = dMid.name;
}

function updateUrlState() {
var url = new URL(window.location);
url.searchParams.set('period', currentAncientPeriod);

var currentText = document.getElementById('textInput').value.trim();

if (selectedWordIndex !== null) {
url.searchParams.set('word', ancientData[selectedWordIndex].k);
url.searchParams.delete('text');
} else if (currentText !== "") {
url.searchParams.delete('word');
url.searchParams.set('text', currentText);
} else {
url.searchParams.delete('word');
url.searchParams.delete('text');
}

window.history.replaceState(null, '', url);
}

function copyCurrentUrl() {
updateUrlState();
var url = window.location.href;
navigator.clipboard.writeText(url).then(function() {
var btn = document.getElementById('copyUrlBtn');
var originalText = btn.textContent;
btn.textContent = "âœ…";
btn.classList.add('copied');
setTimeout(function() {
btn.textContent = originalText;
btn.classList.remove('copied');
}, 2000);
});
}

function shareOnX() {
updateUrlState();
var url = window.location.href;
var text = "é­å¿—å€­äººä¼ãƒ»å¤ä»£ç™ºéŸ³ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼";
var hashtags = "å¤ä»£æ—¥æœ¬èª,é‚ªé¦¬å°å›½";

if (selectedWordIndex !== null) {
var data = ancientData[selectedWordIndex];
var pron = document.getElementById('textInput').value;
text = `ã€Œ${data.k}ã€ã®${periodNames[currentAncientPeriod]}ï¼š${pron} ã‚’å†ç”Ÿä¸­ğŸ”Š`;
} else {
var manualText = document.getElementById('textInput').value.trim();
if (manualText) {
text = `IPAã€Œ${manualText}ã€ã®${periodNames[currentAncientPeriod]}ç™ºéŸ³ã‚’å†ç”Ÿä¸­ğŸ”Š`;
}
}

var shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}&hashtags=${encodeURIComponent(hashtags)}`;
window.open(shareUrl, '_blank');
}

function populateVoiceList() {
voices = synth.getVoices();
var voiceSelect = document.getElementById('voiceSelect');
voiceSelect.innerHTML = '<option value="">è‡ªå‹•é¸æŠ (æ¨å¥¨)</option>';

voices.forEach(function(voice, index) {
if (voice.lang.indexOf('en') === 0) {
var option = document.createElement('option');
option.textContent = `${voice.name} (${voice.lang})`;
option.value = index;
voiceSelect.appendChild(option);
}
});
}

function updateBadges(wordText, isHighlight) {
var wordBadge = document.getElementById('currentWordDisplay');
var periodBadge = document.getElementById('currentPeriodDisplay');

if (!wordText && selectedWordIndex === null) {
wordBadge.style.display = 'none';
periodBadge.style.display = 'none';
} else {
wordBadge.textContent = 'èªå¥: ' + wordText;
wordBadge.style.display = 'inline-block';
wordBadge.style.color = isHighlight ? 'var(--danger)' : 'var(--primary-dark)';
periodBadge.textContent = 'ä½“ç³»: ' + periodNames[currentAncientPeriod];
periodBadge.style.display = 'inline-block';
}
}

function selectPeriod(cardElementOrId, period) {
var card;
if (typeof cardElementOrId === 'string') {
card = document.getElementById(cardElementOrId);
} else {
card = cardElementOrId;
}

document.querySelectorAll('.period-card').forEach(el => el.classList.remove('active'));
if (card) card.classList.add('active');

if (card) {
var radio = card.querySelector('input');
if (radio) radio.checked = true;
}

currentAncientPeriod = period;

if (selectedWordIndex !== null) {
var data = ancientData[selectedWordIndex];
var newPron = data[currentAncientPeriod];

updateBadges(data.k, data.highlight);

if (newPron && newPron !== "(ãƒ‡ãƒ¼ã‚¿ãªã—)") {
document.getElementById('textInput').value = newPron;
updatePreview();
if (!isHistoryPlaying) {
setTimeout(speak, 50);
}
}
}

updateUrlState();

var searchTerm = document.getElementById('searchInput').value;
updateAncientExamples(searchTerm);
updatePreview();
}

function updateAncientExamples(filterTerm) {
var container = document.getElementById('examplesList');
container.innerHTML = '';

var types = ['ä¸»è¦å›½å', 'å‚å›½', 'äººå', 'å®˜è·å', 'ãŠã¾ã‘ï¼ˆãƒ©ãƒ†ãƒ³èªï¼‰'];

types.forEach(function(type) {
var filteredItems = ancientData.filter(function(d) {
if (d.type !== type) return false;
if (!filterTerm) return true;
return d.k.includes(filterTerm) ||
(d.ja && d.ja.includes(filterTerm));
});

if (filteredItems.length === 0) return;

var group = document.createElement('div');
group.className = 'category-group';

// Changed to h3
var header = document.createElement('h3');
header.className = 'category-header';
header.textContent = type;
group.appendChild(header);

var grid = document.createElement('div');
grid.className = 'item-grid';

filteredItems.forEach(function(data) {
var originalIndex = ancientData.indexOf(data);
var pron = data[currentAncientPeriod] || "(ãƒ‡ãƒ¼ã‚¿ãªã—)";
var kanjiClass = data.highlight ? 'wc-kanji text-variant' : 'wc-kanji';
var noteHtml = data.highlight ? `<div class="wc-note">${data.note}</div>` : '';
var jaText = data.ja ? data.ja : '';

var card = document.createElement('div');
card.className = 'word-card';
card.innerHTML = `
<div class="${kanjiClass}">${data.k}</div>
<div class="wc-ja">${jaText}</div>
<div class="wc-pron">${pron}</div>
${noteHtml}
`;

card.onclick = function() {
if (isHistoryPlaying) stopHistory();
if (pron && pron !== "(ãƒ‡ãƒ¼ã‚¿ãªã—)") {
selectedWordIndex = originalIndex;

if (data.labels) {
updatePeriodLabels(data.labels);
} else {
updatePeriodLabels(null);
}

updateBadges(data.k, data.highlight);

document.getElementById('textInput').value = pron;
updatePreview();
updateUrlState();
speak();
}
};
grid.appendChild(card);
});

group.appendChild(grid);
container.appendChild(group);
});
}

function convertIPAToSpeech(text) {
var result = text;
var keys = Object.keys(ipaToSpeech);
keys.sort(function(a, b) { return b.length - a.length; });
for (var i = 0; i < keys.length; i++) {
var ipa = keys[i];
var replacement = ipaToSpeech[ipa];
if (replacement !== undefined) {
var escaped = ipa.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
var reg = new RegExp(escaped, 'g');
result = result.replace(reg, replacement);
}
}
return result.toLowerCase();
}

function updatePreview() {
var text = document.getElementById('textInput').value;
var previewDiv = document.getElementById('conversionPreview');
previewDiv.textContent = text.trim() ? 'èª­ä¸Šã’ç”¨å¤‰æ›: ' + convertIPAToSpeech(text) : '';
}

function updateValue(id) {
document.getElementById(id + 'Value').textContent = document.getElementById(id).value;
}

function setStatus(isPlaying) {
var statusContainer = document.getElementById('playStatus');
var statusLabel = document.getElementById('statusLabel');
if (isPlaying) {
statusContainer.classList.add('playing');
statusLabel.textContent = "å†ç”Ÿä¸­...";
} else {
statusContainer.classList.remove('playing');
statusLabel.textContent = "å¾…æ©Ÿä¸­";
}
}

function speak(onEndCallback) {
if (synth.speaking) synth.cancel();
setStatus(false);

var text = document.getElementById('textInput').value;
if (!text.trim()) {
if (onEndCallback) onEndCallback();
return;
}

var textToSpeak = convertIPAToSpeech(text);
var utterance = new SpeechSynthesisUtterance(textToSpeak);
utterance.rate = parseFloat(document.getElementById('rate').value);
utterance.pitch = parseFloat(document.getElementById('pitch').value);
utterance.volume = parseFloat(document.getElementById('volume').value);

var voiceSelect = document.getElementById('voiceSelect');
var selectedVoiceIndex = voiceSelect.value;

if (selectedVoiceIndex !== "") {
utterance.voice = voices[selectedVoiceIndex];
} else {
var enVoice = null;
if (voices.length > 0) {
for (var i = 0; i < voices.length; i++) {
if (voices[i].lang === 'en-US') { enVoice = voices[i]; break; }
}
if (!enVoice) {
for (var i = 0; i < voices.length; i++) {
if (voices[i].lang.indexOf('en') === 0) { enVoice = voices[i]; break; }
}
}
if (enVoice) utterance.voice = enVoice;
}
}

utterance.onstart = function() { setStatus(true); };
utterance.onend = function() {
setStatus(false);
if (onEndCallback) onEndCallback();
};
utterance.onerror = function(e) {
console.error("Speech Error:", e);
setStatus(false);
if (onEndCallback) onEndCallback();
};

synth.speak(utterance);
}

function stopSpeech() {
synth.cancel();
setStatus(false);
stopHistory();
}

function playHistory() {
if (selectedWordIndex === null) {
alert("å…ˆã«ä¸€è¦§ã‹ã‚‰èªå¥ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
return;
}
if (isHistoryPlaying) return;

isHistoryPlaying = true;
document.getElementById('historyBtn').classList.add('active');
document.getElementById('historyBtn').textContent = "â¬› åœæ­¢";

var sequence = ['old', 'third', 'mid'];
var seqIndex = 0;

function playNextStep() {
if (!isHistoryPlaying) return;
if (seqIndex >= sequence.length) {
stopHistory();
return;
}

var p = sequence[seqIndex];
selectPeriod('card-' + p, p);

setTimeout(function() {
if (!isHistoryPlaying) return;
speak(function() {
seqIndex++;
setTimeout(playNextStep, 800);
});
}, 500);
}
playNextStep();
}

function stopHistory() {
isHistoryPlaying = false;
document.getElementById('historyBtn').classList.remove('active');
document.getElementById('historyBtn').textContent = "ğŸ” å¤‰é·å†ç”Ÿ";
}

function toggleHistory() {
if (isHistoryPlaying) {
stopSpeech();
} else {
playHistory();
}
}

function checkUrlParams() {
var params = new URLSearchParams(window.location.search);
var word = params.get('word');
var period = params.get('period');
var textParam = params.get('text');

if (period && ['old', 'third', 'mid'].includes(period)) {
selectPeriod('card-' + period, period);
}

if (word) {
var index = ancientData.findIndex(function(d) {
return d.k === word;
});

if (index !== -1) {
selectedWordIndex = index;
var data = ancientData[index];
var pron = data[currentAncientPeriod];

if (data.labels) {
updatePeriodLabels(data.labels);
} else {
updatePeriodLabels(null);
}

updateBadges(data.k, data.highlight);
if (pron) {
document.getElementById('textInput').value = pron;
updatePreview();
}
document.getElementById('searchInput').value = word;
updateAncientExamples(word);
}
} else if (textParam) {
document.getElementById('textInput').value = textParam;
updatePreview();
updatePeriodLabels(null);
}
}

function init() {
document.getElementById('speakBtn').onclick = function() { speak(); };
document.getElementById('stopBtn').onclick = stopSpeech;
document.getElementById('historyBtn').onclick = toggleHistory;
document.getElementById('copyUrlBtn').onclick = copyCurrentUrl;
document.getElementById('shareXBtn').onclick = shareOnX;

document.getElementById('searchInput').addEventListener('input', function(e) {
updateAncientExamples(e.target.value);
});

document.getElementById('textInput').oninput = function() {
selectedWordIndex = null;
updatePeriodLabels(null);
updateBadges(null);
updatePreview();
updateUrlState();
if (isHistoryPlaying) stopHistory();
};

['rate', 'pitch', 'volume'].forEach(id => {
document.getElementById(id).oninput = function() { updateValue(id); };
});

document.addEventListener('keydown', function(e) {
if (e.target.tagName !== 'TEXTAREA' && e.target.tagName !== 'INPUT') {
if (e.code === 'Space') {
e.preventDefault();
if (synth.speaking) stopSpeech();
else speak();
}
}
});

populateVoiceList();
if (speechSynthesis.onvoiceschanged !== undefined) {
speechSynthesis.onvoiceschanged = populateVoiceList;
}

updateAncientExamples();
checkUrlParams();
}

if (document.readyState === 'loading') {
document.addEventListener('DOMContentLoaded', init);
} else {
init();
}
</script>
<div style="
position: fixed;
bottom: 20px;
right: 20px;
font-size: 0.8rem;
color: #333;
background: rgba(255, 255, 255, 0.9);
padding: 5px 10px;
border-radius: 5px;
box-shadow: 0 2px 5px rgba(0,0,0,0.2);
z-index: 9999;
">
License: <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" style="color: #0066cc; text-decoration: underline;">CC BY-NC-SA 4.0</a>
</div>
</body>
</html>